Now done for most actions; also triggered an overdue rewrite of the
menu generation code.
