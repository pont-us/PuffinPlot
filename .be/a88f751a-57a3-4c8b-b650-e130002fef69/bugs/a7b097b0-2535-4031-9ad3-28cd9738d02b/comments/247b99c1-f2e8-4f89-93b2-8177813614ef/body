I think this is now working well enough to close the issue, though
it still doesn't implement the manual range selection described in
the paper. Any further required improvements can get their own ticket.
